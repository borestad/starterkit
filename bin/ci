#!/bin/bash -eEu

. `dirname $0`/_helpers

cd "$(dirname $0)"

function trap-exit {
  err=$?
  #failure
  #exit $err
  #git status
  #git diff

}

function trap-error {
  err=$?
  #git status -s
  #git diff
  #failure
}

trap trap-error EXIT
trap trap-finish INT TERM


line 'Yarn install'         && yarn && \
line 'Lint'                 && yarn lint && \
line 'Run tests'            && yarn test --coverage --ci && \
line 'Build packages'       && \
lerna run build --stream    && \
./publish
